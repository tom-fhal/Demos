---
title: "Analyse exploratoire des données de l'enquête sur la participation électorale (2017)"
output: html_document
---

# Plan de travail
1. Introduction 
2. Chargement et préparation des données
3. Analyse exploratoire : Analyse univariée, bivariée, réduction de dimension 
4. Application d'un modèle de régression
5. Application d'un modèle de classification (clustering)
6. Conclusion, synthèse de l'analyse

## 1. Introduction
Ce document présente une analyse exploratoire des données de l'enquête sur la participation électorale de 2017 par département (96 départements). Les données 2014 et 2015 sont diffusées selon la géographie en vigueur au 1er janvier 2016.

### Description des variables
- Department : nom du département
- Code : numéro du département
- HLM : pourcentage du nombre de locataires HLM
- Salairemoy : moyenne du salaire horaire net 
- Ouvrier : pourcentage d'ouvriers présents par rapport aux emplois disponibles
- Employé : pourcentage d'employés présents par apport aux emplois disponibles
- PI : pourcentage de professions intermédiaires par rapport aux emplois disponibles
- Cadres : pourcentage de cadre par apport aux emplois disponibles
- Artisan : pourcentage du nombres d'artisans par apport aux emplois disponibles
- Agri : pourcentage du nombres d'agriculteurs par apport aux emplois disponibles
- TxPauv : taux de pauvreté en 2014
- NonDiplome : pourcentage de personnes non scolarisées de 15 ans ou des non ou peu diplômés
- txcho : taux de chomâge au 2ème trimestre 2017
- txabs : taux d'abstention aux éléctions présidentielles de 2017


## 2. Chargement et préparation des données

```{r}
library(dplyr)
library(ggplot2)     
library(factoextra)   
library(compositions)
library(corrplot)  
library(FactoMineR) 
```
Nous commençons par charger les données pour explorer leur structure et leur contenu.

```{r}
df <- read.csv("data/data_abs.csv", header = TRUE, sep = ",")
df
```
Nous avons 15 colonnes et 96 observations (cela correspond au 96 départements).

```{r}
str(df)
```
Nos colonnes sont du bon type. On peut voir que nous avons principalement des données numériques.

```{r}
colSums(is.na(df)) 
```
Nous n'avons pas de valeurs manquantes dans le dataset.


## 3. Analyse exploratoire

### Analyse univariée

#### Statistiques descriptives
```{r}
summary(df)
```
#### Boîtes à moustaches des variables numériques
```{r}
numeric_vars <- c("HLM", "Salairemoy", "Ouvrier", "Employe", "PI", 
                  "Cadres", "Artisant", "Agri", "TxPauv", "NonDiplome", "txcho", "txabs")
df_numeric <- df[, numeric_vars]
df_long <- stack(df_numeric)
boxplot(values ~ ind, data = df_long, 
        main = "Boîtes à moustaches des variables numériques", 
        xlab = "", ylab = "Valeurs", las = 2, col = "lightblue",
        outline = TRUE) 
mtext("Variables", side = 1, line = 4) 
```

#### Histogrammes des variables continues
```{r}
library(ggplot2)     
ggplot(df_long, aes(x = values)) +
  geom_histogram(bins = 30, fill = "blue", alpha = 0.7) +
  facet_wrap(~ind, scales = "free") +
  theme_minimal() +
  labs(title = "Distributions des variables continues", y = "Fréquence") +
  theme(axis.title.x = element_blank()) + 
  theme(strip.text = element_text(size = 12)) 
```

### Analyse bivariée

#### Corrélation des variables numériques
```{r}
library(corrplot)  

if(!require(corrplot)) install.packages("corrplot")
cor_matrix <- stats::cor(df_numeric, use = "complete.obs")
corrplot(cor_matrix, method = "color", type = "upper", tl.col = "black", tl.srt = 45,
         col = colorRampPalette(c("red", "white", "blue"))(200), 
         title = "Matrice de Corrélation", mar = c(0, 0, 1, 0))
```
#### Relation entre le taux d'abstention et d'autres variables

```{r}
ggplot(df, aes(x = Salairemoy, y = txabs)) + 
  geom_point() + 
  theme_minimal() +
  labs(title = "Salaire moyen vs Taux d'abstention")
```
```{r}
ggplot(df, aes(x = txcho, y = txabs)) + 
  geom_point() + 
  theme_minimal() +
  labs(title = "Taux de chômage vs Taux d'abstention")
```

```{r}
ggplot(df, aes(x = TxPauv, y = txabs)) + 
  geom_point() + 
  theme_minimal() +
  labs(title = "Taux de pauvreté vs Taux d'abstention")
```
```{r}
ggplot(df, aes(x = HLM, y = txabs)) + 
  geom_point() + 
  theme_minimal() +
  labs(title = "HLM vs Taux d'abstention")
```
Combien avons-nous de variables descriptives ? Lesquelles parmi elles
sont-elles des données compositionnelles ? Comment allons nous les traiter ? 

### Réduction de dimension (ACP)

```{r}
library(compositions)
library(FactoMineR)
library(factoextra)

compositionnal_vars <- c("HLM", "Ouvrier", "Employe", "Cadres", "Artisant", "Agri")

data_clr <- clr(df_numeric[, compositionnal_vars])

other_vars <- df_numeric[, !colnames(df_numeric) %in% compositionnal_vars]


data_combined <- cbind(as.data.frame(data_clr), other_vars)


result_acp_combined <- PCA(data_combined, scale.unit = TRUE, ncp = 5, graph = FALSE)

fviz_screeplot(result_acp_combined)         
fviz_pca_var(result_acp_combined)        
fviz_pca_ind(result_acp_combined)           
```

```{r}
data_acp <- scale(df_numeric)     
result_acp <- PCA(as.data.frame(data_acp), scale.unit = TRUE, ncp = 5, graph = FALSE)

fviz_screeplot(result_acp)
fviz_pca_var(result_acp)
fviz_pca_ind(result_acp)
```
## 4. Application d'un modèle de régression
Nous allons appliquer une régression pour modéliser la relation entre le taux d'abstention et les autres variables socio-économiques.

## 5. Application d'un modèle de classification (clustering)
Nous allons appliquer une méthode de classification (clusterinf) afin de regrouper les départements en fonction de leurs caractéristiques socio-économiques et leur taux d'abstention. 


## 6 Conclusion, synthèse de l'analyse

