---
title: "Analyse exploratoire des données de l'enquête sur la participation électorale"
output: html_document
author: "Giovannetti Antonella"
date: "\`r format(Sys.Date(), '%d %B %Y')\`"
---

# Plan de travail

1.  Introduction
2.  Chargement et préparation des données
3.  Analyse exploratoire : Analyse univariée, bivariée, réduction de dimension
4.  Application d'un modèle de régression
5.  Application d'un modèle de classification (clustering)
6.  Conclusion, synthèse de l'analyse

## 1. Introduction

Ce document présente une analyse exploratoire des données de l'enquête sur la participation électorale de 2017 par département (96 départements). Les données 2014 et 2015 sont diffusées selon la géographie en vigueur au 1er janvier 2016.

### Description des variables

-   Department : nom du département
-   Code : numéro du département
-   HLM : pourcentage du nombre de locataires HLM
-   Salairemoy : moyenne du salaire horaire net
-   Ouvrier : pourcentage d'ouvriers présents par rapport aux emplois disponibles
-   Employé : pourcentage d'employés présents par apport aux emplois disponibles
-   PI : pourcentage de professions intermédiaires par rapport aux emplois disponibles
-   Cadres : pourcentage de cadre par apport aux emplois disponibles
-   Artisan : pourcentage du nombres d'artisans par apportaux em plois disponibles
-   Agri : pourcentage du nombres d'agriculteurs par apport aux emplois disponibles
-   TxPauv : taux de pauvreté en 2014
-   NonDiplome : pourcentage de personnes non scolarisées de 15 ans ou des non ou peu diplômés
-   txcho : taux de chomâge au 2ème trimestre 2017
-   txabs : taux d'abstention aux éléctions présidentielles de 2017

## 2. Chargement et préparation des données

```{r}
library(ggplot2)     
library(dplyr)
library(factoextra)   
library(compositions)
library(corrplot)  
library(FactoMineR) 
```

Nous commençons par charger les données pour explorer leur structure et leur contenu.

```{r}
df <- read.csv("data/data_abs.csv", header = TRUE, sep = ",")
df
```

Nous avons 15 colonnes et 96 observations (cela correspond au 96 départements).

```{r}
str(df)
```

Nos colonnes sont du bon type. On peut voir que nous avons principalement des données numériques.

```{r}
colSums(is.na(df)) 
```

Nous n'avons pas de valeurs manquantes dans le dataset.

## 3. Analyse exploratoire

### Analyse univariée

#### Statistiques descriptives

```{r}
library(knitr)
library(kableExtra)

summary_table <- summary(df)
kable(summary_table, format = "html") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = TRUE)

```

Les statistiques montrent des différences importantes entre les départements en termes de conditions socio-économiques. Par exemple, la part des locataires HLM va de 4,5 % à 32,4 %, ce qui reflète des écarts entre les zones urbaines et rurales. Le salaire moyen varie aussi beaucoup, entre 11,29 € et 22,16 €, montrant des inégalités de revenus. Les professions sont également différentes selon les départements : les ouvriers et employés représentent la majorité des emplois (environ 23 % et 29 % en moyenne), tandis que les cadres sont moins nombreux, avec une moyenne de 13 % mais atteignent jusqu’à 42 % dans certains endroits.

Le taux de pauvreté varie entre 9,4 % et 28,6 %, et la proportion de personnes peu ou pas diplômées va de 19,7 % à 40,2 %. Le chômage est aussi inégal, entre 5,7 % et 14,4 %. Enfin, le taux d’abstention est en moyenne de 19,92 %, mais peut aller jusqu’à 32,8 %.

Ces différences montrent que certains départements, avec un taux de pauvreté, de chômage, ou de non-diplômés plus élevé, pourraient avoir des taux d’abstention plus importants. La régression aidera à trouver les facteurs qui influencent le plus l’abstention, et le clustering permettra de regrouper les départements en fonction de leurs profils pour mieux comprendre leurs dynamiques.

#### Boîtes à moustaches des variables numériques

```{r}
numeric_vars <- c("HLM", "Salairemoy", "Ouvrier", "Employe", "PI", 
                  "Cadres", "Artisant", "Agri", "TxPauv", "NonDiplome", "txcho", "txabs")
df_numeric <- df[, numeric_vars]
df_long <- stack(df_numeric)
boxplot(values ~ ind, data = df_long, 
        main = "Boîtes à moustaches des variables numériques", 
        xlab = "", ylab = "Valeurs", las = 2, col = "lightblue",
        outline = TRUE) 
mtext("Variables", side = 1, line = 4) 
```

La proportion de locataires HLM, le taux de pauvreté et le pourcentage de personnes non diplômées varient beaucoup, avec certains départements qui se démarquent (outliers). On observe aussi que les catégories professionnelles (comme les cadres ou les agriculteurs) ne sont pas réparties de manière égale, tout comme les salaires. Le taux d'abstention est assez homogène autour de 20 %, il est plus élevé dans certains départements, ce qui pourrait refléter des contextes socio-économiques spécifiques.

#### Histogrammes des variables continues

```{r}
library(ggplot2)     
ggplot(df_long, aes(x = values)) +
  geom_histogram(bins = 30, fill = "blue", alpha = 0.7) +
  facet_wrap(~ind, scales = "free") +
  theme_minimal() +
  labs(title = "Distributions des variables continues", y = "Fréquence") +
  theme(axis.title.x = element_blank()) + 
  theme(strip.text = element_text(size = 12)) 
```

### Analyse bivariée

#### Corrélation des variables numériques

```{r}
library(corrplot)  

if(!require(corrplot)) install.packages("corrplot")
cor_matrix <- stats::cor(df_numeric, use = "complete.obs")
corrplot(cor_matrix, method = "color", type = "upper", tl.col = "black", tl.srt = 45,
         col = colorRampPalette(c("red", "white", "blue"))(200), 
         title = "Matrice de Corrélation", mar = c(0, 0, 1, 0))
```

Sur la matrice de corrélation, on peut observer que les départements avec plus de personnes non diplômées ont souvent un taux de pauvreté plus élevé. Les salaires moyens augmentent dans les départements avec plus de cadres, tandis que les logements sociaux (HLM) sont associés à des taux de chômage plus élevés. On remarque aussi que le taux d'abstention est lié au taux de pauvreté et au pourcentage de non-diplômés, ce qui suggère que les contextes socio-économiques défavorisés peuvent influencer la participation électorale.

#### Relation entre le taux d'abstention et d'autres variables


```{r}
ggplot(df, aes(x = Salairemoy, y = txabs)) + 
  geom_point(color = "blue", alpha = 0.7) + 
  geom_smooth(method = "lm", color = "red", se = TRUE) + 
  theme_minimal() +
  labs(title = "Moyenne du salaire horaire vs Taux d'abstention",
       x = "Moyenne du salaire horaire",
       y = "Taux d'abstention")

```

```{r}
ggplot(df, aes(x = txcho, y = txabs)) + 
  geom_point(color = "blue", alpha = 0.7) + 
  geom_smooth(method = "lm", color = "red", se = TRUE) + 
  theme_minimal() +
  labs(title = "Taux de chômage vs Taux d'abstention",
       x = "Taux de chômage",
       y = "Taux d'abstention")

```

```{r}
ggplot(df, aes(x = TxPauv, y = txabs)) + 
  geom_point() + 
  theme_minimal() +
  labs(title = "Taux de pauvreté vs Taux d'abstention")
```

```{r}
ggplot(df, aes(x = HLM, y = txabs)) + 
  geom_point(color = "blue", alpha = 0.7) + 
  geom_smooth(method = "lm", color = "red", se = TRUE) + 
  theme_minimal() +
  labs(title = "HLM vs Taux d'abstention",
       x = "Taux de chômage",
       y = "Taux d'abstention")
```

Dans notre jeu de données, nous avons 11 variables descriptives : HLM, Salairemoy, Ouvrier, Employe, PI, Cadres, Artisant, Agri, TxPauv, NonDiplome et Txcho. Ainsi que des données compositionelles, qui sont des données exprimées en pourcentages ou proportions : Ouvrier, Employe, PI, Cadres, Artisant et Agri.

Pour analyser correctement les données compositionelles, nous devons éviter les biais dus à leur nature fixe (elles dépendent toutes d'un même total). On applique une transformation CLR sur les données compositionelles pour rendre les données indépendantes, puis on standardise l'ensemble des données.

### Réduction de dimension (ACP)

```{r}
library(compositions)
library(FactoMineR)
library(factoextra)

compositionnal_vars <- c("HLM", "Ouvrier", "Employe", "Cadres", "Artisant", "Agri")

data_clr <- clr(df_numeric[, compositionnal_vars])

other_vars <- df_numeric[, !colnames(df_numeric) %in% compositionnal_vars]


data_combined <- cbind(as.data.frame(data_clr), other_vars)


data_combined_scaled <- scale(data_combined)

result_acp_combined <- PCA(data_combined_scaled, scale.unit = TRUE, ncp = 2, graph = FALSE)

fviz_screeplot(result_acp_combined)         
fviz_pca_var(result_acp_combined)        
fviz_pca_ind(result_acp_combined)  
```

Les résultats de l'ACP sont visualisés grâce à trois graphiques :

-   fviz_screeplot() : Montre l'inertie expliquée par chaque composante principale pour identifier celles qui capturent le plus d'informations Interprétation : On observe que les deux premières dimensions (Dim1 et Dim2) expliquent une grande partie de la variance totale : environ 34,8 % pour Dim1 et 23,9 % pour Dim2, soit près de 59 % au total. Cela suggère que la réduction de dimension est efficace, car les deux premières composantes principales capturent une majorité de l'information contenue dans les données.

-   fviz_pca_var() : Représente les varibales dans l'espace des composantes principales pour montrer leurs contributions Interprétation : Les variables "TxPauv" et "NonDiplome" sont fortement corrélées positivement. Cela pourrait indiquer que des zones ayant un taux élevé de pauvreté ont également un pourcentage important de personnes sans diplôme. Les variables comme "HLM", "PI" et "Cadres" sont positionnées de manière opposée à "TxPauv" et "NonDiplome", indiquant une corrélation négative. Cela pourrait refléter que les zones avec plus de cadres ou de logements sociaux pourraient avoir une pauvreté et une absence de diplôme moins marquées. La direction et la longueur des flèches montrent l'influence des variables sur les axes principaux. Par exemple, "Salairemoy" semble fortement contribuer à Dim1.

-   fviz_pca_ind() : Affiche les départements dans l'espace des composantes principales pour voir comment ils se positionnent par apport aux variables

```{r}
fviz_contrib(result_acp_combined, choice = "var", axes = 1) 
fviz_contrib(result_acp_combined, choice = "var", axes = 2) 
seuil <- 5 
important_vars <- colnames(data_combined)[result_acp_combined$var$contrib[, 1] > seuil]
important_vars
```

## 5. Application d'un modèle de classification (clustering)

Nous allons appliquer une méthode de classification (clustering) afin de regrouper les départements en fonction de leurs caractéristiques socio-économiques et leur taux d'abstention.

```{r}
fviz_nbclust(data_combined_scaled, kmeans, method = "wss") 
fviz_nbclust(data_combined_scaled, kmeans, method = "silhouette")  
```

```{r}
k <- 2
result_kmeans <- kmeans(data_combined_scaled, centers = k, nstart = 25)

print(result_kmeans$cluster)

data_combined$cluster <- as.factor(result_kmeans$cluster)

fviz_cluster(result_kmeans, data = data_combined_scaled, geom = "point", ellipse.type = "convex")


dist_matrix <- dist(data_combined_scaled)

result_hclust <- hclust(dist_matrix, method = "ward.D2")


```
